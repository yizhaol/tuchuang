"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[75],{2896:function(e,t,r){r.d(t,{Z:function(){return c}});var a=r(7437),n=r(2265),s=r(5017),i=r(8614),l=r(9597),o=r(4833);function c(e){let{isOpen:t,onClose:r,onSuccess:c}=e,[d,u]=(0,n.useState)(""),[m,x]=(0,n.useState)(!1),[f,g]=(0,n.useState)(""),[h,p]=(0,n.useState)(!1),[y,b]=(0,n.useState)(null),[j,w]=(0,n.useState)("new");(0,n.useEffect)(()=>{t&&((0,s.Pi)()?w("manage"):(b(null),w("new")),u(""),g(""),p(!1))},[t]);let N=async e=>{if(e.preventDefault(),!d.trim()){g("请输入API Key");return}x(!0),g("");try{await (0,s.Gw)(d)?(p(!0),u(d),setTimeout(()=>{p(!1),c(d),r()},1200)):g("API Key无效，请重试")}catch(e){g("验证失败，请重试")}finally{x(!1)}},v=()=>{(0,s.o0)(),w("new"),b(null)};return t?"manage"===j?(0,a.jsx)(i.M,{children:(0,a.jsx)(l.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,a.jsxs)(l.E.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-slate-800 rounded-xl p-6 max-w-md w-full mx-4 shadow-2xl",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)("div",{className:"bg-green-100 dark:bg-green-900/30 p-3 rounded-full mr-4 relative",children:(0,a.jsx)(o.nQ,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"API 密钥管理"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"您想要管理您的 API 密钥吗？"}),(0,a.jsx)("div",{className:"bg-gray-50 dark:bg-slate-700 p-4 rounded-lg border border-gray-200 dark:border-gray-600",children:(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("span",{className:"bg-green-100 dark:bg-green-900/40 text-green-600 dark:text-green-400 px-2 py-1 rounded-full text-sm",children:"已验证密钥"})})})]}),(0,a.jsxs)("ul",{className:"mb-6 space-y-2 text-sm",children:[(0,a.jsxs)("li",{className:"flex items-start",children:[(0,a.jsx)("span",{className:"mr-2",children:"•"}),(0,a.jsx)("span",{className:"text-gray-600 dark:text-gray-300",children:"确定: 清除当前 API 密钥并输入新的密钥"})]}),(0,a.jsxs)("li",{className:"flex items-start",children:[(0,a.jsx)("span",{className:"mr-2",children:"•"}),(0,a.jsx)("span",{className:"text-gray-600 dark:text-gray-300",children:"取消: 保持当前设置"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{r()},className:"px-4 py-2.5 rounded-lg border border-gray-200 dark:border-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"取消"}),(0,a.jsx)(l.E.button,{onClick:()=>{v(),r()},className:"px-4 py-2.5 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-lg hover:from-indigo-600 hover:to-purple-700 focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:focus:ring-offset-slate-800 shadow-md transition-all",whileHover:{scale:1.03},whileTap:{scale:.97},children:"确定"})]})]})})}):(0,a.jsx)(i.M,{children:t&&(0,a.jsx)(l.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,a.jsxs)(l.E.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-slate-800 rounded-xl p-6 max-w-md w-full mx-4 shadow-2xl overflow-hidden relative",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsxs)("div",{className:"bg-indigo-100 dark:bg-indigo-900/30 p-3 rounded-full mr-4 relative",children:[!h&&(0,a.jsx)(o.kh,{className:"h-6 w-6 text-indigo-600 dark:text-indigo-400"}),h&&(0,a.jsx)(l.E.div,{initial:{scale:.5,opacity:0},animate:{scale:[.5,1.2,1],opacity:1,rotate:[0,10,-10,0]},transition:{duration:.5,times:[0,.6,.9,1],ease:"easeInOut"},className:"absolute inset-0 flex items-center justify-center",children:(0,a.jsx)(o.nQ,{className:"h-6 w-6 text-green-500"})})]}),(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"API 密钥验证"})]}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"请输入您的 API 密钥以使用 ImageFlow 服务"}),(0,a.jsxs)("form",{onSubmit:N,children:[(0,a.jsxs)("div",{className:"relative mb-6",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:(0,a.jsx)(o.kh,{className:"h-5 w-5 text-gray-400"})}),(0,a.jsx)("input",{type:"password",value:d,onChange:e=>u(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-200 dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent dark:bg-slate-700 dark:text-white text-sm transition-all duration-200",placeholder:"输入您的API密钥",autoFocus:!0})]}),(0,a.jsx)(i.M,{children:f&&(0,a.jsx)(l.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"p-3 mb-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-600 dark:text-red-400 rounded-lg text-sm",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(o.H4,{className:"h-5 w-5 mr-2 flex-shrink-0"}),f]})})}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2.5 rounded-lg border border-gray-200 dark:border-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"取消"}),(0,a.jsx)(l.E.button,{type:"submit",disabled:m||h,className:"px-4 py-2.5 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-lg hover:from-indigo-600 hover:to-purple-700 focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:focus:ring-offset-slate-800 shadow-md disabled:opacity-70 transition-all",whileHover:{scale:1.03},whileTap:{scale:.97},children:m?(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(o.$j,{className:"-ml-1 mr-2 h-4 w-4 text-white"}),"验证中"]}):h?(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(o.nQ,{className:"mr-2 h-4 w-4 text-white"}),"验证成功"]}):"验证"})]})]})]})})}):null}},3521:function(e,t,r){r.d(t,{Z:function(){return c}});var a=r(7437),n=r(7648),s=r(6973),i=r(9376),l=r(9597),o=r(4833);function c(e){let{onApiKeyClick:t,title:r,isKeyVerified:c=!1}=e,{isDarkMode:d,toggleTheme:u}=(0,s.F)(),m=(0,i.usePathname)();return(0,a.jsxs)("div",{className:"flex items-center justify-between mb-10",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(n.default,{href:"/",className:"mr-4",children:(0,a.jsx)("div",{className:"bg-gradient-primary w-14 h-14 rounded-2xl flex items-center justify-center shadow-lg transform rotate-12 hover:rotate-0 transition-transform duration-300",children:(0,a.jsx)(o.XB,{className:"h-8 w-8 text-white"})})}),(0,a.jsx)("h1",{className:"text-4xl font-bold bg-clip-text text-transparent bg-gradient-primary",children:r||("/manage"===m?"图片管理":"ImageFlow")})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:["/manage"!==m&&(0,a.jsx)(n.default,{href:"/manage",className:"btn-icon",children:(0,a.jsx)(o.RY,{className:"h-6 w-6"})}),(0,a.jsxs)("button",{onClick:t,className:"btn-icon relative",children:[(0,a.jsx)(o.kh,{className:"h-6 w-6"}),c&&(0,a.jsx)(l.E.div,{className:"absolute -top-1 -right-1 w-4 h-4 bg-green-500 rounded-full flex items-center justify-center shadow-lg",initial:{scale:0,opacity:0},animate:{scale:1,opacity:1,boxShadow:["0 0 0 0 rgba(34, 197, 94, 0.4)","0 0 0 8px rgba(34, 197, 94, 0)","0 0 0 0 rgba(34, 197, 94, 0)"]},transition:{scale:{duration:.3,ease:"easeOut"},opacity:{duration:.3,ease:"easeOut"},boxShadow:{duration:2,repeat:1/0,ease:"easeOut"}},children:(0,a.jsx)(l.E.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,duration:.2},className:"w-2 h-2 bg-white rounded-full"})})]}),(0,a.jsx)("button",{onClick:u,className:"btn-icon",children:d?(0,a.jsx)(o.NW,{className:"h-6 w-6 text-amber-500"}):(0,a.jsx)(o.kL,{className:"h-6 w-6 text-gray-700 dark:text-gray-300"})})]})]})}},4833:function(e,t,r){r.d(t,{$j:function(){return I},Dr:function(){return S.Z},H4:function(){return h.Z},Jj:function(){return P},LP:function(){return y.Z},NN:function(){return w.Z},NW:function(){return k.Z},RY:function(){return Z.Z},SP:function(){return s.Z},T3:function(){return f.Z},TI:function(){return N.Z},XB:function(){return n.Z},XH:function(){return o.Z},_8:function(){return p.Z},_V:function(){return m.Z},aA:function(){return j.Z},dq:function(){return c.Z},hs:function(){return u.Z},kL:function(){return v.Z},kh:function(){return x.Z},lO:function(){return g.Z},nQ:function(){return d.Z},pO:function(){return i.Z},rG:function(){return b.Z},v4:function(){return E.Z},yp:function(){return l.Z}});var a=r(7437),n=r(3113),s=r(6937),i=r(9397),l=r(2489),o=r(8930),c=r(5136),d=r(401),u=r(2208),m=r(3247),x=r(6748),f=r(1723),g=r(3954),h=r(3245),p=r(2735),y=r(6865),b=r(7689),j=r(9658),w=r(5363),N=r(8867),v=r(7226),k=r(5929),Z=r(8293),E=r(875),S=r(8335);let P={success:e=>{let{className:t=""}=e;return(0,a.jsx)(d.Z,{className:"text-green-500 ".concat(t)})},error:e=>{let{className:t=""}=e;return(0,a.jsx)(l.Z,{className:"text-red-500 ".concat(t)})},warning:e=>{let{className:t=""}=e;return(0,a.jsx)(y.Z,{className:"text-amber-500 ".concat(t)})},info:e=>{let{className:t=""}=e;return(0,a.jsx)(h.Z,{className:"text-blue-500 ".concat(t)})}},I=e=>{let{className:t=""}=e;return(0,a.jsxs)("svg",{className:"animate-spin ".concat(t),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}},6973:function(e,t,r){r.d(t,{F:function(){return n}});var a=r(2265);function n(){let[e,t]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{let e=localStorage.getItem("theme");e&&(t("dark"===e),document.documentElement.classList.toggle("dark","dark"===e))},[]),{isDarkMode:e,toggleTheme:()=>{let r=!e;t(r),localStorage.setItem("theme",r?"dark":"light"),document.documentElement.classList.toggle("dark",r)}}}},5017:function(e,t,r){r.d(t,{Gw:function(){return l},Lb:function(){return s},Pi:function(){return n},o0:function(){return i}});let a="imageflow_api_key",n=()=>localStorage.getItem(a),s=e=>{localStorage.setItem(a,e)},i=()=>{localStorage.removeItem(a)},l=async e=>{try{let t=await fetch("".concat("","/api/validate-api-key"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(!t.ok){let e=await t.text();return console.error("API Key validation failed:",{status:t.status,statusText:t.statusText,responseText:e}),!1}let r=await t.json();return!0===r.valid}catch(e){return console.error("API Key validation error:",e),!1}}},3594:function(e,t,r){r.d(t,{m:function(){return a}});function a(e){if(!e)return"";if(e.startsWith("http://")||e.startsWith("https://"))return e;try{return new URL(e,(0,window.location.origin)).toString()}catch(t){return console.error("URL格式错误:",t),e}}},1214:function(e,t,r){r.d(t,{v:function(){return a}});async function a(e){if(navigator.clipboard&&"function"==typeof navigator.clipboard.writeText)try{return await navigator.clipboard.writeText(e),!0}catch(e){console.error("Clipboard API 失败:",e)}try{let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.opacity="0",t.style.pointerEvents="none",t.style.left="-999px",t.style.top="0",document.body.appendChild(t),t.focus(),t.select();let r=document.execCommand("copy");if(document.body.removeChild(t),r)return!0;console.error("execCommand 复制失败")}catch(e){console.error("文档复制方法失败:",e)}return!1}},6329:function(e,t,r){r.d(t,{hi:function(){return o}});var a=r(5017);let n="",s=!1;async function i(){try{let e=await fetch("/api/config"),t=await e.json();t.apiUrl&&(n=t.apiUrl)}catch(e){console.error("Failed to fetch API config:",e)}}async function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};s||(await i(),s=!0);let r=(0,a.Pi)(),{params:l,...o}=t,c=new URL(e,n||window.location.origin);if(console.log(n,c.toString()),l)for(let[e,t]of Object.entries(l))c.searchParams.append(e,t);let d={Authorization:"Bearer ".concat(r),...t.headers},u=await fetch(c.toString(),{...o,headers:d});if(!u.ok)throw Error((await u.json().catch(()=>({}))).message||"请求失败");return u.json()}let o={request:l,get:(e,t)=>l(e,{method:"GET",params:t}),post:(e,t)=>l(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),delete:e=>l(e,{method:"DELETE"}),upload:(e,t)=>{let r=new FormData;for(let e of t)r.append("images[]",e);return l(e,{method:"POST",body:r})}}}}]);